name: php_319_dependency_injection
initial:
  UserRepository.php: |
    <?php
    class UserRepository {
        public function find(int $id): array {
            return ['id' => $id, 'name' => 'User'];
        }

        public function save(array $data): bool {
            return true;
        }
    }
  UserService.php: |
    <?php
    class UserService {}
changed:
  UserService.php: |
    <?php
    require_once 'UserRepository.php';

    class UserService {
        public function __construct(private UserRepository $repo) {}

        public function getUser(int $id): array {
            return $this->repo->find($id);
        }

        public function createUser(array $data): bool {
            return $this->repo->save($data);
        }
    }
assertions:
  must_include:
  - UserRepository $repo
  - find
  - save
  must_not_include:
  - garbage_marker_12345
  - unused_marker_67890
options:
  commit_message: Add dependency injection
