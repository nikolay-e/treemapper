name: rust_022_unsafe_ffi
initial:
  src/ffi.rs: |
    extern "C" {
        fn external_function(x: i32) -> i32;
    }

    pub fn safe_wrapper(x: i32) -> i32 {
        unsafe { external_function(x) }
    }
changed:
  src/ffi.rs: |
    extern "C" {
        fn external_function(x: i32) -> i32;
        fn another_external(s: *const u8, len: usize) -> i32;
    }

    pub fn safe_wrapper(x: i32) -> i32 {
        unsafe { external_function(x) }
    }

    pub fn safe_string_wrapper(s: &str) -> i32 {
        unsafe { another_external(s.as_ptr(), s.len()) }
    }
assertions:
  must_include:
  - another_external
  - safe_string_wrapper
  must_not_include:
  - garbage_ffi_function
options:
  commit_message: Add another FFI function
