name: rust_021_cfg_feature
initial:
  src/config.rs: |
    #[cfg(feature = "json")]
    use serde_json;

    pub struct Config {
        pub name: String,
    }

    #[cfg(feature = "json")]
    impl Config {
        pub fn from_json(s: &str) -> Self {
            serde_json::from_str(s).unwrap()
        }
    }
changed:
  src/config.rs: |
    #[cfg(feature = "json")]
    use serde_json;

    #[cfg(feature = "yaml")]
    use serde_yaml;

    pub struct Config {
        pub name: String,
        pub version: String,
    }

    #[cfg(feature = "json")]
    impl Config {
        pub fn from_json(s: &str) -> Self {
            serde_json::from_str(s).unwrap()
        }
    }

    #[cfg(feature = "yaml")]
    impl Config {
        pub fn from_yaml(s: &str) -> Self {
            serde_yaml::from_str(s).unwrap()
        }
    }
assertions:
  must_include:
  - from_yaml
  - serde_yaml
  - version
  must_not_include:
  - garbage_config_method
options:
  commit_message: Add yaml feature support
