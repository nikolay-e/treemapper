name: rust_031_mutable_borrow
initial:
  src/data.rs: |
    pub struct Data {
        values: Vec<i32>,
    }

    impl Data {
        pub fn new() -> Self {
            Self { values: Vec::new() }
        }

        pub fn add(&mut self, value: i32) {
            self.values.push(value);
        }

        pub fn get(&self, index: usize) -> Option<&i32> {
            self.values.get(index)
        }
    }
  src/processor.rs: |
    use crate::data::Data;

    pub fn process(data: &Data) {
        if let Some(val) = data.get(0) {
            println!("First value: {}", val);
        }
    }
changed:
  src/processor.rs: |
    use crate::data::Data;

    pub fn process(data: &mut Data) {
        data.add(42);
        if let Some(val) = data.get(0) {
            println!("First value: {}", val);
        }
    }

    pub fn process_multiple(data: &mut Data, count: usize) {
        for i in 0..count {
            data.add(i as i32);
        }
    }
assertions:
  must_include:
  - process_multiple
  - '&mut Data'
  must_not_include:
  - garbage_processor_fn
options:
  commit_message: Change to mutable borrow
