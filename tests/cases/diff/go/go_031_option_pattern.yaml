name: go_031_option_pattern
initial:
  client.go: |
    package main

    type Client struct {
        baseURL string
        timeout int
    }

    func NewClient(baseURL string) *Client {
        return &Client{baseURL: baseURL}
    }
  unrelated/garbage.go: |
    package unrelated

    func UnusedClient_12345() {
        println("garbage_marker_12345")
    }

    func AnotherUnused_67890() {
        println("unused_marker_67890")
    }
changed:
  client.go: |
    package main

    import "time"

    type Client struct {
        baseURL   string
        timeout   time.Duration
        retries   int
        userAgent string
    }

    type Option func(*Client)

    func WithTimeout(d time.Duration) Option {
        return func(c *Client) {
            c.timeout = d
        }
    }

    func WithRetries(n int) Option {
        return func(c *Client) {
            c.retries = n
        }
    }

    func WithUserAgent(ua string) Option {
        return func(c *Client) {
            c.userAgent = ua
        }
    }

    func NewClient(baseURL string, opts ...Option) *Client {
        c := &Client{
            baseURL: baseURL,
            timeout: 30 * time.Second,
            retries: 3,
        }
        for _, opt := range opts {
            opt(c)
        }
        return c
    }
assertions:
  must_include:
  - Client
  - Option
  - WithTimeout
  - WithRetries
  must_not_include:
  - garbage_marker_12345
  - unused_marker_67890
options:
  commit_message: Add functional options
