name: go_026_struct_tags
initial:
  internal/api/models.go: |
    package api

    type User struct {
        ID   int
        Name string
    }

    type Product struct {
        ID    int
        Name  string
        Price float64
    }

    type Order struct {
        ID        int
        UserID    int
        ProductID int
        Quantity  int
    }

  internal/api/handlers.go: |
    package api

    import (
        "encoding/json"
        "net/http"
    )

    func SerializeUser(w http.ResponseWriter, u *User) error {
        return json.NewEncoder(w).Encode(u)
    }

    func SerializeProduct(w http.ResponseWriter, p *Product) error {
        return json.NewEncoder(w).Encode(p)
    }

  internal/unrelated/payments/stripe_client.go: |
    package payments

    import "context"

    const GARBAGE_GO_STRIPE_CLIENT_A1B2C3 = "stripe_garbage_marker"

    type GARBAGE_GO_TYPE_CHARGE_D4E5F6 struct {
        amount   int64
        currency string
        source   string
    }

    func GARBAGE_GO_FUNC_STRIPE_G7H8I9() string {
        return "GARBAGE_GO_STRIPE_UNUSED_J0K1L2"
    }

    type StripeConfig struct {
        APIKey         string
        WebhookSecret  string
        PublishableKey string
    }

    func GARBAGE_GO_FUNC_CREATE_CHARGE_M3N4O5(ctx context.Context, amount int64) error {
        println("GARBAGE_GO_STRIPE_OUTPUT_P6Q7R8")
        return nil
    }

  internal/unrelated/payments/paypal_gateway.go: |
    package payments

    const GARBAGE_GO_PAYPAL_GATEWAY_S9T0U1 = "paypal_garbage"

    type GARBAGE_GO_TYPE_PAYPAL_V2W3X4 struct {
        clientID     string
        clientSecret string
        sandbox      bool
    }

    func GARBAGE_GO_FUNC_PAYPAL_Y5Z6A7() {
        println("GARBAGE_GO_PAYPAL_OUTPUT_B8C9D0")
    }

    type PayPalConfig struct {
        ClientID     string
        ClientSecret string
        Environment  string
    }

    func GARBAGE_GO_FUNC_PAYPAL_ORDER_E1F2G3(orderID string) error {
        return nil
    }

  internal/unrelated/payments/crypto_wallet.go: |
    package payments

    const GARBAGE_GO_CRYPTO_WALLET_H4I5J6 = "crypto_garbage"

    type GARBAGE_GO_TYPE_BITCOIN_K7L8M9 struct {
        address    string
        privateKey string
    }

    func GARBAGE_GO_FUNC_CRYPTO_N0O1P2() {
        println("GARBAGE_GO_CRYPTO_OUTPUT_Q3R4S5")
    }

changed:
  internal/api/models.go: |
    package api

    import (
        "time"
    )

    type UserRole string

    const (
        UserRoleAdmin     UserRole = "admin"
        UserRoleModerator UserRole = "moderator"
        UserRoleUser      UserRole = "user"
        UserRoleGuest     UserRole = "guest"
    )

    type User struct {
        ID          int64     `json:"id" db:"id" gorm:"primaryKey;autoIncrement"`
        ExternalID  string    `json:"external_id" db:"external_id" gorm:"uniqueIndex;size:36"`
        Name        string    `json:"name" db:"full_name" gorm:"column:full_name;size:255" validate:"required,min=2,max=100"`
        Email       string    `json:"email,omitempty" db:"email" gorm:"uniqueIndex;size:255" validate:"required,email"`
        Phone       string    `json:"phone,omitempty" db:"phone_number" gorm:"column:phone_number;size:20" validate:"omitempty,e164"`
        Role        UserRole  `json:"role" db:"role" gorm:"type:varchar(20);default:'user'" validate:"required,oneof=admin moderator user guest"`
        IsActive    bool      `json:"is_active" db:"is_active" gorm:"default:true"`
        Preferences string    `json:"-" db:"preferences" gorm:"type:jsonb"`
        CreatedAt   time.Time `json:"created_at" db:"created_at" gorm:"autoCreateTime"`
        UpdatedAt   time.Time `json:"updated_at" db:"updated_at" gorm:"autoUpdateTime"`
    }

    func (User) TableName() string {
        return "users"
    }

    type Product struct {
        ID          int64   `json:"id" db:"id" gorm:"primaryKey;autoIncrement"`
        SKU         string  `json:"sku" db:"sku" gorm:"uniqueIndex;size:50" validate:"required,alphanum,min=3,max=50"`
        Name        string  `json:"name" db:"name" gorm:"size:255;index" validate:"required,min=2,max=200"`
        Description string  `json:"description,omitempty" db:"description" gorm:"type:text"`
        Price       float64 `json:"price" db:"price" gorm:"type:decimal(10,2);check:price >= 0" validate:"required,gte=0"`
        Currency    string  `json:"currency" db:"currency" gorm:"size:3;default:'USD'" validate:"required,iso4217"`
        Stock       int     `json:"stock" db:"stock_quantity" gorm:"column:stock_quantity;default:0;check:stock_quantity >= 0" validate:"gte=0"`
        Weight      float64 `json:"weight_kg,omitempty" db:"weight" gorm:"type:decimal(8,3)" validate:"omitempty,gte=0"`
        CategoryID  *int64  `json:"category_id,omitempty" db:"category_id" gorm:"index"`
        IsPublished bool    `json:"is_published" db:"is_published" gorm:"default:false;index"`
        Metadata    string  `json:"-" db:"metadata" gorm:"type:jsonb;default:'{}'"`
        CreatedAt   time.Time `json:"created_at" db:"created_at" gorm:"autoCreateTime"`
        UpdatedAt   time.Time `json:"updated_at" db:"updated_at" gorm:"autoUpdateTime"`
    }

    func (Product) TableName() string {
        return "products"
    }

    type OrderStatus string

    const (
        OrderStatusPending    OrderStatus = "pending"
        OrderStatusProcessing OrderStatus = "processing"
        OrderStatusShipped    OrderStatus = "shipped"
        OrderStatusDelivered  OrderStatus = "delivered"
        OrderStatusCancelled  OrderStatus = "cancelled"
    )

    type Order struct {
        ID            int64       `json:"id" db:"id" gorm:"primaryKey;autoIncrement"`
        OrderNumber   string      `json:"order_number" db:"order_number" gorm:"uniqueIndex;size:20" validate:"required"`
        UserID        int64       `json:"user_id" db:"user_id" gorm:"index;not null" validate:"required"`
        Status        OrderStatus `json:"status" db:"status" gorm:"type:varchar(20);default:'pending';index" validate:"required,oneof=pending processing shipped delivered cancelled"`
        Subtotal      float64     `json:"subtotal" db:"subtotal" gorm:"type:decimal(12,2);not null" validate:"required,gte=0"`
        Tax           float64     `json:"tax" db:"tax" gorm:"type:decimal(10,2);default:0" validate:"gte=0"`
        ShippingCost  float64     `json:"shipping_cost" db:"shipping_cost" gorm:"type:decimal(10,2);default:0" validate:"gte=0"`
        Total         float64     `json:"total" db:"total" gorm:"type:decimal(12,2);not null" validate:"required,gte=0"`
        Currency      string      `json:"currency" db:"currency" gorm:"size:3;default:'USD'" validate:"required,iso4217"`
        ShippingAddr  string      `json:"shipping_address" db:"shipping_address" gorm:"type:jsonb;not null" validate:"required"`
        BillingAddr   string      `json:"billing_address,omitempty" db:"billing_address" gorm:"type:jsonb"`
        Notes         string      `json:"notes,omitempty" db:"notes" gorm:"type:text"`
        PaymentMethod string      `json:"payment_method" db:"payment_method" gorm:"size:50" validate:"required"`
        PaidAt        *time.Time  `json:"paid_at,omitempty" db:"paid_at"`
        ShippedAt     *time.Time  `json:"shipped_at,omitempty" db:"shipped_at"`
        DeliveredAt   *time.Time  `json:"delivered_at,omitempty" db:"delivered_at"`
        CreatedAt     time.Time   `json:"created_at" db:"created_at" gorm:"autoCreateTime;index"`
        UpdatedAt     time.Time   `json:"updated_at" db:"updated_at" gorm:"autoUpdateTime"`
    }

    func (Order) TableName() string {
        return "orders"
    }

    type OrderItem struct {
        ID        int64   `json:"id" db:"id" gorm:"primaryKey;autoIncrement"`
        OrderID   int64   `json:"order_id" db:"order_id" gorm:"index;not null" validate:"required"`
        ProductID int64   `json:"product_id" db:"product_id" gorm:"index;not null" validate:"required"`
        SKU       string  `json:"sku" db:"sku" gorm:"size:50;not null"`
        Name      string  `json:"name" db:"product_name" gorm:"column:product_name;size:255;not null"`
        Quantity  int     `json:"quantity" db:"quantity" gorm:"not null;check:quantity > 0" validate:"required,gte=1"`
        UnitPrice float64 `json:"unit_price" db:"unit_price" gorm:"type:decimal(10,2);not null" validate:"required,gte=0"`
        Total     float64 `json:"total" db:"total" gorm:"type:decimal(12,2);not null" validate:"required,gte=0"`
    }

    func (OrderItem) TableName() string {
        return "order_items"
    }

assertions:
  must_include:
    - User
    - Product
    - Order
    - OrderItem
    - "json:"
    - "db:"
    - "gorm:"
    - "validate:"
    - TableName
    - OrderStatus
    - UserRole
    - primaryKey
    - uniqueIndex
    - autoCreateTime
  must_not_include:
    - GARBAGE_GO_STRIPE_CLIENT_A1B2C3
    - GARBAGE_GO_TYPE_CHARGE_D4E5F6
    - GARBAGE_GO_FUNC_STRIPE_G7H8I9
    - GARBAGE_GO_STRIPE_UNUSED_J0K1L2
    - GARBAGE_GO_FUNC_CREATE_CHARGE_M3N4O5
    - GARBAGE_GO_STRIPE_OUTPUT_P6Q7R8
    - GARBAGE_GO_PAYPAL_GATEWAY_S9T0U1
    - GARBAGE_GO_TYPE_PAYPAL_V2W3X4
    - GARBAGE_GO_FUNC_PAYPAL_Y5Z6A7
    - GARBAGE_GO_PAYPAL_OUTPUT_B8C9D0
    - GARBAGE_GO_FUNC_PAYPAL_ORDER_E1F2G3
    - GARBAGE_GO_CRYPTO_WALLET_H4I5J6
    - GARBAGE_GO_TYPE_BITCOIN_K7L8M9
    - GARBAGE_GO_FUNC_CRYPTO_N0O1P2
    - GARBAGE_GO_CRYPTO_OUTPUT_Q3R4S5
    - stripe_client
    - paypal_gateway
    - crypto_wallet

options:
  commit_message: Add comprehensive struct tags for JSON, DB, GORM, and validation
