name: node_001_express_middleware
initial:
  authMiddleware.ts: |
    import { Request, Response, NextFunction } from 'express';

    export function authMiddleware(req: Request, res: Response, next: NextFunction) {
        const token = req.headers.authorization;
        if (!token) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        next();
    }

    // node_garbage_marker_001
    const GARBAGE_MIDDLEWARE_CONFIG = { skipPaths: [] };
  app.ts: |
    console.log('initial');
changed:
  app.ts: |
    import express from 'express';
    import { authMiddleware } from './authMiddleware';

    const app = express();
    app.use(authMiddleware);

    app.get('/protected', (req, res) => {
        res.json({ message: 'Protected content' });
    });
assertions:
  must_include:
  - app.ts
  must_not_include:
  - node_garbage_marker_001
options:
  commit_message: Add middleware usage
