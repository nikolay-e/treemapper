name: python_037_from_import
initial:
  helpers.py: |
    from typing import Optional, List, Dict, Any
    from datetime import datetime, date, timedelta
    from decimal import Decimal, ROUND_HALF_UP
    import re

    DATE_FORMAT = "%Y-%m-%d"
    TIME_FORMAT = "%H:%M:%S"
    DATETIME_FORMAT = "%Y-%m-%d %H:%M:%S"

    def format_date(dt: datetime) -> str:
        return dt.strftime(DATE_FORMAT)

    def format_time(dt: datetime) -> str:
        return dt.strftime(TIME_FORMAT)

    def format_datetime(dt: datetime) -> str:
        return dt.strftime(DATETIME_FORMAT)

    def parse_date(date_str: str) -> Optional[date]:
        try:
            return datetime.strptime(date_str, DATE_FORMAT).date()
        except ValueError:
            return None

    def parse_datetime(dt_str: str) -> Optional[datetime]:
        try:
            return datetime.strptime(dt_str, DATETIME_FORMAT)
        except ValueError:
            return None

    def format_currency(amount: Decimal, currency: str = "USD") -> str:
        rounded = amount.quantize(Decimal("0.01"), rounding=ROUND_HALF_UP)
        symbols = {"USD": "$", "EUR": "€", "GBP": "£"}
        symbol = symbols.get(currency, currency + " ")
        return f"{symbol}{rounded:,.2f}"

    def slugify(text: str) -> str:
        text = text.lower().strip()
        text = re.sub(r"[^\w\s-]", "", text)
        text = re.sub(r"[\s_-]+", "-", text)
        return text.strip("-")

    class DateRange:
        def __init__(self, start: date, end: date):
            self.start = start
            self.end = end

        def days(self) -> int:
            return (self.end - self.start).days

        def contains(self, dt: date) -> bool:
            return self.start <= dt <= self.end

  event_view.py: |
    from helpers import format_date

    class Event:
        def __init__(self, title: str, date: datetime):
            self.title = title
            self.date = date

    def render():
        pass

  unrelated/image_processor.py: |
    GARBAGE_PYTHON_037_001 = "image processor marker"
    GARBAGE_PYTHON_037_002 = "image format constant"

    class ImageDimensions:
        GARBAGE_PYTHON_037_003 = "dimensions class marker"

        def __init__(self, width: int, height: int):
            self.width = width
            self.height = height

  unrelated/pdf_generator.py: |
    GARBAGE_PYTHON_037_004 = "pdf generator marker"
    GARBAGE_PYTHON_037_005 = "pdf page size constant"

    class PDFDocument:
        GARBAGE_PYTHON_037_006 = "document class marker"

        def __init__(self, title: str):
            self.title = title

  unrelated/csv_exporter.py: |
    GARBAGE_PYTHON_037_007 = "csv exporter marker"
    GARBAGE_PYTHON_037_008 = "csv delimiter constant"

    class CSVExporter:
        GARBAGE_PYTHON_037_009 = "exporter class marker"

        def __init__(self, delimiter: str = ","):
            self.delimiter = delimiter

changed:
  helpers.py: |
    from typing import Optional, List, Dict, Any
    from datetime import datetime, date, timedelta
    from decimal import Decimal, ROUND_HALF_UP
    import re

    DATE_FORMAT = "%Y-%m-%d"
    TIME_FORMAT = "%H:%M:%S"
    DATETIME_FORMAT = "%Y-%m-%d %H:%M:%S"
    ISO_FORMAT = "%Y-%m-%dT%H:%M:%S"

    def format_date(dt: datetime) -> str:
        return dt.strftime(DATE_FORMAT)

    def format_time(dt: datetime) -> str:
        return dt.strftime(TIME_FORMAT)

    def format_datetime(dt: datetime) -> str:
        return dt.strftime(DATETIME_FORMAT)

    def format_iso(dt: datetime) -> str:
        return dt.strftime(ISO_FORMAT)

    def parse_date(date_str: str) -> Optional[date]:
        try:
            return datetime.strptime(date_str, DATE_FORMAT).date()
        except ValueError:
            return None

    def parse_datetime(dt_str: str) -> Optional[datetime]:
        try:
            return datetime.strptime(dt_str, DATETIME_FORMAT)
        except ValueError:
            return None

    def parse_iso(dt_str: str) -> Optional[datetime]:
        try:
            return datetime.strptime(dt_str, ISO_FORMAT)
        except ValueError:
            return None

    def format_currency(amount: Decimal, currency: str = "USD") -> str:
        rounded = amount.quantize(Decimal("0.01"), rounding=ROUND_HALF_UP)
        symbols = {"USD": "$", "EUR": "€", "GBP": "£", "JPY": "¥"}
        symbol = symbols.get(currency, currency + " ")
        return f"{symbol}{rounded:,.2f}"

    def slugify(text: str) -> str:
        text = text.lower().strip()
        text = re.sub(r"[^\w\s-]", "", text)
        text = re.sub(r"[\s_-]+", "-", text)
        return text.strip("-")

    def truncate(text: str, max_length: int, suffix: str = "...") -> str:
        if len(text) <= max_length:
            return text
        return text[:max_length - len(suffix)] + suffix

    class DateRange:
        def __init__(self, start: date, end: date):
            self.start = start
            self.end = end

        def days(self) -> int:
            return (self.end - self.start).days

        def contains(self, dt: date) -> bool:
            return self.start <= dt <= self.end

        def overlaps(self, other: "DateRange") -> bool:
            return self.start <= other.end and other.start <= self.end

assertions:
  must_include:
    - def format_iso
    - def parse_iso
    - def truncate
    - ISO_FORMAT
    - overlaps
  must_not_include:
    - GARBAGE_PYTHON_037_001
    - GARBAGE_PYTHON_037_002
    - GARBAGE_PYTHON_037_003
    - GARBAGE_PYTHON_037_004
    - GARBAGE_PYTHON_037_005
    - GARBAGE_PYTHON_037_006
    - GARBAGE_PYTHON_037_007
    - GARBAGE_PYTHON_037_008
    - GARBAGE_PYTHON_037_009
    - ImageDimensions
    - PDFDocument
    - CSVExporter
    - image_processor.py
    - pdf_generator.py
    - csv_exporter.py
