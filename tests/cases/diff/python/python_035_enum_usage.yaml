name: python_035_enum_usage
initial:
  enums.py: |
    from enum import Enum, auto, IntEnum, Flag
    from typing import List, Optional

    class OrderStatus(Enum):
        PENDING = auto()
        PROCESSING = auto()
        SHIPPED = auto()
        DELIVERED = auto()
        CANCELLED = auto()

        def is_terminal(self) -> bool:
            return self in (OrderStatus.DELIVERED, OrderStatus.CANCELLED)

        def can_cancel(self) -> bool:
            return self in (OrderStatus.PENDING, OrderStatus.PROCESSING)

    class PaymentMethod(str, Enum):
        CREDIT_CARD = "credit_card"
        DEBIT_CARD = "debit_card"
        PAYPAL = "paypal"
        BANK_TRANSFER = "bank_transfer"

        @classmethod
        def card_methods(cls) -> List["PaymentMethod"]:
            return [cls.CREDIT_CARD, cls.DEBIT_CARD]

    class Priority(IntEnum):
        LOW = 1
        MEDIUM = 2
        HIGH = 3
        CRITICAL = 4

        def is_urgent(self) -> bool:
            return self >= Priority.HIGH

    class Permission(Flag):
        NONE = 0
        READ = auto()
        WRITE = auto()
        DELETE = auto()
        ADMIN = READ | WRITE | DELETE

        def can_read(self) -> bool:
            return bool(self & Permission.READ)

  orders.py: |
    from enums import OrderStatus, Priority

    class Order:
        def __init__(self, order_id: int):
            self.order_id = order_id
            self.status = OrderStatus.PENDING

  unrelated/shipping_calculator.py: |
    GARBAGE_PYTHON_035_001 = "shipping calculator marker"
    GARBAGE_PYTHON_035_002 = "shipping rate constant"

    class ShippingZone:
        GARBAGE_PYTHON_035_003 = "zone class marker"

        def __init__(self, zone_id: str, rate_multiplier: float = 1.0):
            self.zone_id = zone_id
            self.rate_multiplier = rate_multiplier

        def calculate_rate(self, base_rate: float) -> float:
            return base_rate * self.rate_multiplier

  unrelated/tax_service.py: |
    GARBAGE_PYTHON_035_004 = "tax service marker"
    GARBAGE_PYTHON_035_005 = "tax rate constant"

    class TaxCalculator:
        GARBAGE_PYTHON_035_006 = "calculator class marker"

        def __init__(self, tax_rate: float = 0.08):
            self.tax_rate = tax_rate

        def calculate_tax(self, amount: float) -> float:
            return amount * self.tax_rate

  unrelated/discount_engine.py: |
    GARBAGE_PYTHON_035_007 = "discount engine marker"
    GARBAGE_PYTHON_035_008 = "discount constant"

    class DiscountRule:
        GARBAGE_PYTHON_035_009 = "rule class marker"

        def __init__(self, percentage: float):
            self.percentage = percentage

        def apply(self, amount: float) -> float:
            return amount * (1 - self.percentage / 100)

changed:
  enums.py: |
    from enum import Enum, auto, IntEnum, Flag
    from typing import List, Optional

    class OrderStatus(Enum):
        PENDING = auto()
        PROCESSING = auto()
        SHIPPED = auto()
        DELIVERED = auto()
        CANCELLED = auto()
        REFUNDED = auto()

        def is_terminal(self) -> bool:
            return self in (OrderStatus.DELIVERED, OrderStatus.CANCELLED, OrderStatus.REFUNDED)

        def can_cancel(self) -> bool:
            return self in (OrderStatus.PENDING, OrderStatus.PROCESSING)

        def next_status(self) -> Optional["OrderStatus"]:
            transitions = {
                OrderStatus.PENDING: OrderStatus.PROCESSING,
                OrderStatus.PROCESSING: OrderStatus.SHIPPED,
                OrderStatus.SHIPPED: OrderStatus.DELIVERED,
            }
            return transitions.get(self)

    class PaymentMethod(str, Enum):
        CREDIT_CARD = "credit_card"
        DEBIT_CARD = "debit_card"
        PAYPAL = "paypal"
        BANK_TRANSFER = "bank_transfer"
        CRYPTO = "crypto"

        @classmethod
        def card_methods(cls) -> List["PaymentMethod"]:
            return [cls.CREDIT_CARD, cls.DEBIT_CARD]

        @classmethod
        def digital_methods(cls) -> List["PaymentMethod"]:
            return [cls.PAYPAL, cls.CRYPTO]

    class Priority(IntEnum):
        LOW = 1
        MEDIUM = 2
        HIGH = 3
        CRITICAL = 4
        URGENT = 5

        def is_urgent(self) -> bool:
            return self >= Priority.HIGH

        def display_name(self) -> str:
            return self.name.replace("_", " ").title()

    class Permission(Flag):
        NONE = 0
        READ = auto()
        WRITE = auto()
        DELETE = auto()
        EXECUTE = auto()
        ADMIN = READ | WRITE | DELETE | EXECUTE

        def can_read(self) -> bool:
            return bool(self & Permission.READ)

        def can_write(self) -> bool:
            return bool(self & Permission.WRITE)

assertions:
  must_include:
    - class OrderStatus
    - class Priority
    - class PaymentMethod
    - Enum
    - auto
    - REFUNDED
    - next_status
  must_not_include:
    - GARBAGE_PYTHON_035_001
    - GARBAGE_PYTHON_035_002
    - GARBAGE_PYTHON_035_003
    - GARBAGE_PYTHON_035_004
    - GARBAGE_PYTHON_035_005
    - GARBAGE_PYTHON_035_006
    - GARBAGE_PYTHON_035_007
    - GARBAGE_PYTHON_035_008
    - GARBAGE_PYTHON_035_009
    - ShippingZone
    - TaxCalculator
    - DiscountRule
    - shipping_calculator.py
    - tax_service.py
    - discount_engine.py
