name: java_032_generic_repository
initial:
  src/main/java/com/inventory/repository/ProductRepository.java: |
    package com.inventory.repository;

    import com.inventory.model.Product;
    import org.springframework.stereotype.Repository;
    import java.util.ArrayList;
    import java.util.HashMap;
    import java.util.List;
    import java.util.Map;
    import java.util.Optional;

    @Repository
    public class ProductRepository {
        private final Map<String, Product> products = new HashMap<>();

        public Product save(Product product) {
            products.put(product.getId(), product);
            return product;
        }

        public Optional<Product> findById(String id) {
            return Optional.ofNullable(products.get(id));
        }

        public List<Product> findAll() {
            return new ArrayList<>(products.values());
        }

        public void deleteById(String id) {
            products.remove(id);
        }

        public boolean existsById(String id) {
            return products.containsKey(id);
        }

        public long count() {
            return products.size();
        }
    }
  src/main/java/com/inventory/model/Product.java: |
    package com.inventory.model;

    import java.math.BigDecimal;
    import java.time.Instant;
    import java.util.UUID;

    public class Product {
        private String id;
        private String name;
        private String description;
        private BigDecimal price;
        private int stockQuantity;
        private String category;
        private Instant createdAt;
        private Instant updatedAt;

        public Product() {
            this.id = UUID.randomUUID().toString();
            this.createdAt = Instant.now();
            this.updatedAt = Instant.now();
        }

        public String getId() { return id; }
        public void setId(String id) { this.id = id; }
        public String getName() { return name; }
        public void setName(String name) { this.name = name; }
        public String getDescription() { return description; }
        public void setDescription(String description) { this.description = description; }
        public BigDecimal getPrice() { return price; }
        public void setPrice(BigDecimal price) { this.price = price; }
        public int getStockQuantity() { return stockQuantity; }
        public void setStockQuantity(int stockQuantity) { this.stockQuantity = stockQuantity; }
        public String getCategory() { return category; }
        public void setCategory(String category) { this.category = category; }
        public Instant getCreatedAt() { return createdAt; }
        public void setCreatedAt(Instant createdAt) { this.createdAt = createdAt; }
        public Instant getUpdatedAt() { return updatedAt; }
        public void setUpdatedAt(Instant updatedAt) { this.updatedAt = updatedAt; }
    }
  src/main/java/com/unrelated/audio/SoundWaveAnalyzer.java: |
    package com.unrelated.audio;

    public class SoundWaveAnalyzer {
        public static final String GARBAGE_JAVA_PRICING_R032A = "audio_marker_alpha";
        private static final String GARBAGE_JAVA_MARGIN_R032B = "wave_marker_beta";

        public double calculateFrequency(double[] samples, int sampleRate) {
            logGarbageMarkers();
            return sampleRate / 2.0;
        }

        public double calculateAmplitude(double[] samples) {
            double max = 0;
            for (double sample : samples) {
                max = Math.max(max, Math.abs(sample));
            }
            String GARBAGE_JAVA_DISCOUNT_R032C = "amplitude_marker_gamma";
            System.out.println(GARBAGE_JAVA_DISCOUNT_R032C);
            return max;
        }

        private void logGarbageMarkers() {
            System.out.println(GARBAGE_JAVA_PRICING_R032A + GARBAGE_JAVA_MARGIN_R032B);
        }
    }
  src/main/java/com/unrelated/color/RgbConverter.java: |
    package com.unrelated.color;

    public class RgbConverter {
        public static final String GARBAGE_JAVA_ALERT_R032D = "rgb_marker_delta";
        private static final String GARBAGE_JAVA_THRESHOLD_R032E = "hex_marker_epsilon";

        public String rgbToHex(int r, int g, int b) {
            logGarbageMarkers();
            return String.format("#%02X%02X%02X", r, g, b);
        }

        public int[] hexToRgb(String hex) {
            String clean = hex.replace("#", "");
            String GARBAGE_JAVA_LOW_R032F = "convert_marker_zeta";
            System.out.println(GARBAGE_JAVA_LOW_R032F);
            return new int[] {
                Integer.parseInt(clean.substring(0, 2), 16),
                Integer.parseInt(clean.substring(2, 4), 16),
                Integer.parseInt(clean.substring(4, 6), 16)
            };
        }

        private void logGarbageMarkers() {
            System.out.println(GARBAGE_JAVA_ALERT_R032D + GARBAGE_JAVA_THRESHOLD_R032E);
        }
    }
  src/main/java/com/unrelated/distance/UnitConverter.java: |
    package com.unrelated.distance;

    public class UnitConverter {
        public static final String GARBAGE_JAVA_SUPPLIER_R032G = "distance_marker_eta";

        public double milesToKilometers(double miles) {
            String GARBAGE_JAVA_REGISTER_R032H = "miles_marker_theta";
            System.out.println(GARBAGE_JAVA_SUPPLIER_R032G + GARBAGE_JAVA_REGISTER_R032H);
            return miles * 1.60934;
        }

        public double kilometersToMiles(double km) {
            return km / 1.60934;
        }

        public double feetToMeters(double feet) {
            return feet * 0.3048;
        }
    }
changed:
  src/main/java/com/inventory/repository/BaseEntity.java: |
    package com.inventory.repository;

    import java.time.Instant;

    public interface BaseEntity<ID> {
        ID getId();
        void setId(ID id);
        Instant getCreatedAt();
        void setCreatedAt(Instant createdAt);
        Instant getUpdatedAt();
        void setUpdatedAt(Instant updatedAt);
    }
  src/main/java/com/inventory/repository/GenericRepository.java: |
    package com.inventory.repository;

    import java.util.List;
    import java.util.Optional;
    import java.util.function.Predicate;

    public interface GenericRepository<T extends BaseEntity<ID>, ID> {
        T save(T entity);
        List<T> saveAll(Iterable<T> entities);
        Optional<T> findById(ID id);
        List<T> findAll();
        List<T> findAll(Predicate<T> filter);
        List<T> findAllById(Iterable<ID> ids);
        boolean existsById(ID id);
        long count();
        void deleteById(ID id);
        void delete(T entity);
        void deleteAll(Iterable<T> entities);
        void deleteAll();
    }
  src/main/java/com/inventory/repository/InMemoryRepository.java: |
    package com.inventory.repository;

    import java.time.Instant;
    import java.util.*;
    import java.util.concurrent.ConcurrentHashMap;
    import java.util.function.Predicate;
    import java.util.stream.Collectors;
    import java.util.stream.StreamSupport;

    public abstract class InMemoryRepository<T extends BaseEntity<ID>, ID> implements GenericRepository<T, ID> {
        protected final Map<ID, T> store = new ConcurrentHashMap<>();

        @Override
        public T save(T entity) {
            Objects.requireNonNull(entity, "Entity must not be null");
            Instant now = Instant.now();
            if (entity.getId() == null) {
                entity.setId(generateId());
                entity.setCreatedAt(now);
            }
            entity.setUpdatedAt(now);
            store.put(entity.getId(), entity);
            return entity;
        }

        @Override
        public List<T> saveAll(Iterable<T> entities) {
            return StreamSupport.stream(entities.spliterator(), false)
                .map(this::save)
                .collect(Collectors.toList());
        }

        @Override
        public Optional<T> findById(ID id) {
            Objects.requireNonNull(id, "ID must not be null");
            return Optional.ofNullable(store.get(id));
        }

        @Override
        public List<T> findAll() {
            return new ArrayList<>(store.values());
        }

        @Override
        public List<T> findAll(Predicate<T> filter) {
            return store.values().stream()
                .filter(filter)
                .collect(Collectors.toList());
        }

        @Override
        public List<T> findAllById(Iterable<ID> ids) {
            return StreamSupport.stream(ids.spliterator(), false)
                .map(store::get)
                .filter(Objects::nonNull)
                .collect(Collectors.toList());
        }

        @Override
        public boolean existsById(ID id) {
            Objects.requireNonNull(id, "ID must not be null");
            return store.containsKey(id);
        }

        @Override
        public long count() {
            return store.size();
        }

        @Override
        public void deleteById(ID id) {
            Objects.requireNonNull(id, "ID must not be null");
            store.remove(id);
        }

        @Override
        public void delete(T entity) {
            Objects.requireNonNull(entity, "Entity must not be null");
            deleteById(entity.getId());
        }

        @Override
        public void deleteAll(Iterable<T> entities) {
            entities.forEach(this::delete);
        }

        @Override
        public void deleteAll() {
            store.clear();
        }

        protected abstract ID generateId();
    }
  src/main/java/com/inventory/repository/ProductRepository.java: |
    package com.inventory.repository;

    import com.inventory.model.Product;
    import org.springframework.stereotype.Repository;
    import java.math.BigDecimal;
    import java.util.Comparator;
    import java.util.List;
    import java.util.UUID;
    import java.util.stream.Collectors;

    @Repository
    public class ProductRepository extends InMemoryRepository<Product, String> {

        @Override
        protected String generateId() {
            return UUID.randomUUID().toString();
        }

        public List<Product> findByCategory(String category) {
            return findAll(p -> category.equals(p.getCategory()));
        }

        public List<Product> findByNameContaining(String searchTerm) {
            String lowerSearch = searchTerm.toLowerCase();
            return findAll(p -> p.getName().toLowerCase().contains(lowerSearch));
        }

        public List<Product> findByPriceRange(BigDecimal minPrice, BigDecimal maxPrice) {
            return findAll(p ->
                p.getPrice().compareTo(minPrice) >= 0 &&
                p.getPrice().compareTo(maxPrice) <= 0
            );
        }

        public List<Product> findInStock() {
            return findAll(p -> p.getStockQuantity() > 0);
        }

        public List<Product> findLowStock(int threshold) {
            return findAll(p -> p.getStockQuantity() > 0 && p.getStockQuantity() <= threshold);
        }

        public List<Product> findOutOfStock() {
            return findAll(p -> p.getStockQuantity() == 0);
        }

        public List<Product> findTopByPrice(int limit) {
            return findAll().stream()
                .sorted(Comparator.comparing(Product::getPrice).reversed())
                .limit(limit)
                .collect(Collectors.toList());
        }

        public List<Product> findRecentlyUpdated(int limit) {
            return findAll().stream()
                .sorted(Comparator.comparing(Product::getUpdatedAt).reversed())
                .limit(limit)
                .collect(Collectors.toList());
        }
    }
  src/main/java/com/inventory/model/Product.java: |
    package com.inventory.model;

    import com.inventory.repository.BaseEntity;
    import java.math.BigDecimal;
    import java.time.Instant;
    import java.util.Objects;

    public class Product implements BaseEntity<String> {
        private String id;
        private String name;
        private String description;
        private BigDecimal price;
        private int stockQuantity;
        private String category;
        private String sku;
        private boolean active;
        private Instant createdAt;
        private Instant updatedAt;

        public Product() {
            this.active = true;
        }

        @Override
        public String getId() { return id; }
        @Override
        public void setId(String id) { this.id = id; }
        public String getName() { return name; }
        public void setName(String name) { this.name = name; }
        public String getDescription() { return description; }
        public void setDescription(String description) { this.description = description; }
        public BigDecimal getPrice() { return price; }
        public void setPrice(BigDecimal price) { this.price = price; }
        public int getStockQuantity() { return stockQuantity; }
        public void setStockQuantity(int stockQuantity) { this.stockQuantity = stockQuantity; }
        public String getCategory() { return category; }
        public void setCategory(String category) { this.category = category; }
        public String getSku() { return sku; }
        public void setSku(String sku) { this.sku = sku; }
        public boolean isActive() { return active; }
        public void setActive(boolean active) { this.active = active; }
        @Override
        public Instant getCreatedAt() { return createdAt; }
        @Override
        public void setCreatedAt(Instant createdAt) { this.createdAt = createdAt; }
        @Override
        public Instant getUpdatedAt() { return updatedAt; }
        @Override
        public void setUpdatedAt(Instant updatedAt) { this.updatedAt = updatedAt; }

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            Product product = (Product) o;
            return Objects.equals(id, product.id);
        }

        @Override
        public int hashCode() {
            return Objects.hash(id);
        }
    }
assertions:
  must_include:
    - GenericRepository
    - BaseEntity
    - InMemoryRepository
    - saveAll
    - findAllById
    - findAll(Predicate
    - findByCategory
    - findByNameContaining
    - findByPriceRange
    - findInStock
    - findLowStock
    - findTopByPrice
    - generateId
    - ConcurrentHashMap
  must_not_include:
    - GARBAGE_JAVA_PRICING_R032A
    - GARBAGE_JAVA_MARGIN_R032B
    - GARBAGE_JAVA_DISCOUNT_R032C
    - GARBAGE_JAVA_ALERT_R032D
    - GARBAGE_JAVA_THRESHOLD_R032E
    - GARBAGE_JAVA_LOW_R032F
    - GARBAGE_JAVA_SUPPLIER_R032G
    - GARBAGE_JAVA_REGISTER_R032H
    - SoundWaveAnalyzer
    - RgbConverter
    - UnitConverter
    - calculateFrequency
    - calculateAmplitude
    - rgbToHex
    - hexToRgb
    - milesToKilometers
options:
  commit_message: Add generic repository pattern with type-safe CRUD operations
