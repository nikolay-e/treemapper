middleware/auth.py: |
  import time

  class AuthMiddleware:
      def process_request(self, request):
          if not request.get("token"):
              raise ValueError("Unauthorized")
          request["authenticated_at"] = time.time()
          return request
settings.py: |
  MIDDLEWARE = [
      "middleware.auth.AuthMiddleware",
  ]
