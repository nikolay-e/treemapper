name: snapshot_001_report
initial:
  src/report_generator.py: |
    from datetime import datetime

    class ReportGenerator:
        def __init__(self, title: str):
            self.title = title

        def generate_summary(self, data: list[dict]) -> dict:
            total = sum(item.get("value", 0) for item in data)
            count = len(data)
            avg = total / count if count > 0 else 0
            return {
                "title": self.title,
                "total": total,
                "count": count,
                "average": round(avg, 2),
                "items": data,
            }

        def generate_html(self, data: list[dict]) -> str:
            summary = self.generate_summary(data)
            html = f"<html><head><title>{summary['title']}</title></head>"
            html += f"<body><h1>{summary['title']}</h1>"
            html += f"<p>Total: {summary['total']}</p>"
            html += f"<p>Count: {summary['count']}</p>"
            html += f"<p>Average: {summary['average']}</p>"
            html += "<ul>"
            for item in summary["items"]:
                html += f"<li>{item.get('name', 'Unknown')}: {item.get('value', 0)}</li>"
            html += "</ul></body></html>"
            return html
  tests/test_report_generator.py: |
    from src.report_generator import ReportGenerator

    def test_generate_summary_basic():
        generator = ReportGenerator("Test Report")
        data = [{"name": "A", "value": 10}]
        result = generator.generate_summary(data)
        assert result["total"] == 10
changed:
  tests/test_report_generator.py: |
    from src.report_generator import ReportGenerator

    def test_generate_summary_basic():
        generator = ReportGenerator("Test Report")
        data = [{"name": "A", "value": 10}]
        result = generator.generate_summary(data)
        assert result["total"] == 10

    def test_generate_summary_snapshot():
        generator = ReportGenerator("Sales Report")
        data = [
            {"name": "Product A", "value": 100},
            {"name": "Product B", "value": 200},
            {"name": "Product C", "value": 150},
        ]
        result = generator.generate_summary(data)

        expected = {
            "title": "Sales Report",
            "total": 450,
            "count": 3,
            "average": 150.0,
            "items": data,
        }
        assert result == expected

    def test_generate_html_snapshot():
        generator = ReportGenerator("Monthly Summary")
        data = [
            {"name": "Revenue", "value": 5000},
            {"name": "Expenses", "value": 3000},
        ]
        result = generator.generate_html(data)

        assert "<title>Monthly Summary</title>" in result
        assert "<h1>Monthly Summary</h1>" in result
        assert "<p>Total: 8000</p>" in result
        assert "<p>Count: 2</p>" in result
        assert "<p>Average: 4000.0</p>" in result
        assert "<li>Revenue: 5000</li>" in result
        assert "<li>Expenses: 3000</li>" in result
assertions:
  must_include:
  - report_generator
options:
  commit_message: Add snapshot-style assertions for report generation
