name: cross_exception_raised_find_handlers
initial:
  exceptions.py: |
    class InsufficientFundsError(Exception):
        def __init__(self, account_id):
            self.account_id = account_id
            super().__init__(f"Insufficient funds for account {account_id}")
  service.py: |
    def transfer(from_account, to_account, amount):
        return True
  api/views.py: |
    from exceptions import InsufficientFundsError
    from service import transfer

    def transfer_endpoint(request):
        try:
            result = transfer(request.from_id, request.to_id, request.amount)
            return {"success": result}
        except InsufficientFundsError as e:
            return {"error": str(e)}
changed:
  service.py: |
    from exceptions import InsufficientFundsError

    def transfer(from_account, to_account, amount):
        balance = get_balance(from_account)
        if balance < amount:
            raise InsufficientFundsError(from_account)
        return True

    def get_balance(account):
        return 100
assertions:
  must_include:
  - service.py
