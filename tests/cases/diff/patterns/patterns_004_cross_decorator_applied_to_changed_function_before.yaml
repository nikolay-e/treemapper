decorators/auth.py: |
  import functools

  def login_required(func):
      @functools.wraps(func)
      def wrapper(*args, **kwargs):
          if not is_authenticated():
              raise ValueError("Not authenticated")
          return func(*args, **kwargs)
      return wrapper

  def is_authenticated():
      return True

  def admin_only(func):
      @functools.wraps(func)
      def wrapper(*args, **kwargs):
          if not is_admin():
              raise ValueError("Admin access required")
          return func(*args, **kwargs)
      return wrapper

  def is_admin():
      return False
decorators/rate.py: |
  import functools
  import time

  def rate_limit(limit):
      def decorator(func):
          calls = []
          @functools.wraps(func)
          def wrapper(*args, **kwargs):
              now = time.time()
              calls[:] = [c for c in calls if now - c < 60]
              if len(calls) >= limit:
                  raise ValueError("Rate limit exceeded")
              calls.append(now)
              return func(*args, **kwargs)
          return wrapper
      return decorator
api.py: |
  from decorators.auth import login_required
  from decorators.rate import rate_limit

  @login_required
  @rate_limit(100)
  def api_endpoint():
      return {"status": "ok"}

  @login_required
  def user_profile():
      return {"user": "current"}
utils/garbage_cors_handler.py: |
  # GARBAGE_PAT_004_CORS_HANDLER_A
  GARBAGE_PAT_004_ALLOWED_ORIGINS_B = ["*"]

  class GarbageCorsHandler:
      def handle(self, request):
          return request
utils/garbage_request_logger.py: |
  # GARBAGE_PAT_004_REQUEST_LOGGER_A
  GARBAGE_PAT_004_LOG_BODY_B = False

  class GarbageRequestLogger:
      def log(self, request):
          pass
