name: csharp_306_async_disposable
initial:
  Resources/AsyncResource.cs: |
    namespace MyApp.Resources;

    public class AsyncResource : IAsyncDisposable
    {
        private readonly HttpClient _client;

        public AsyncResource()
        {
            _client = new HttpClient();
        }

        public async Task<string> FetchAsync(string url)
        {
            return await _client.GetStringAsync(url);
        }

        public async ValueTask DisposeAsync()
        {
            _client.Dispose();
            await Task.CompletedTask;
        }
    }
    // unused_marker_67890
  Services/AsyncService.cs: |
    namespace MyApp.Services;

    public class AsyncService { }
changed:
  Services/AsyncService.cs: |
    using MyApp.Resources;

    namespace MyApp.Services;

    public class AsyncService
    {
        public async Task<string> FetchDataAsync(string url)
        {
            await using var resource = new AsyncResource();
            return await resource.FetchAsync(url);
        }
    }
assertions:
  must_include:
  - AsyncService
  - AsyncResource
  - FetchDataAsync
  must_not_include:
  - garbage_marker_12345
  - unused_marker_67890
options:
  commit_message: Add IAsyncDisposable usage
