name: config_001_yaml_config_changed_find_code_using_it
initial:
  config.yaml: |
    database:
      pool_size: 5
      timeout: 30
  database/connection.py: |
    import yaml

    def load_config():
        with open("config.yaml") as f:
            config = yaml.safe_load(f)
        return config

    def get_pool():
        config = load_config()
        pool_size = config["database"]["pool_size"]
        return create_pool(pool_size)

    def create_pool(size):
        return {"size": size}
changed:
  config.yaml: |
    database:
      pool_size: 10
      timeout: 30
assertions:
  must_include:
  - config.yaml
options:
  commit_message: Increase pool size
