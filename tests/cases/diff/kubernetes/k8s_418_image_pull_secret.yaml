name: k8s_418_image_pull_secret
initial:
  registry-secret.yaml: |
    apiVersion: v1
    kind: Secret
    metadata:
      name: registry-cred
    type: kubernetes.io/dockerconfigjson
    data:
      .dockerconfigjson: eyJhdXRocyI6e319
  deployment.yaml: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: myapp
    spec:
      template:
        spec:
          containers:
          - name: app
            image: private-registry.io/myapp:latest
  unrelated.txt: |
    garbage_marker_k8s418 = True
    unused_marker_k8s418 = False
changed:
  deployment.yaml: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: myapp
    spec:
      template:
        spec:
          imagePullSecrets:
          - name: registry-cred
          containers:
          - name: app
            image: private-registry.io/myapp:latest
assertions:
  must_include:
  - imagePullSecrets
  must_not_include:
  - garbage_marker_k8s418
  - unused_marker_k8s418
options:
  commit_message: Add image pull secret
