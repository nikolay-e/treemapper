k8s/base/secret.yaml: |
  apiVersion: v1
  kind: Secret
  metadata:
    name: db-secret
    namespace: production
    labels:
      app: myapp
      component: database
  type: Opaque
  data:
    username: cG9zdGdyZXM=
    password: c3VwZXJzZWNyZXRwYXNzd29yZA==
    host: cG9zdGdyZXMuZGF0YWJhc2Uuc3ZjLmNsdXN0ZXIubG9jYWw=
k8s/base/deployment.yaml: |
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: myapp
    namespace: production
    labels:
      app: myapp
      tier: backend
  spec:
    replicas: 3
    selector:
      matchLabels:
        app: myapp
    template:
      metadata:
        labels:
          app: myapp
          tier: backend
      spec:
        containers:
        - name: app
          image: myapp:v1.0.0
          ports:
          - containerPort: 8080
          env:
          - name: DB_USERNAME
            valueFrom:
              secretKeyRef:
                name: db-secret
                key: username
          - name: DB_PASSWORD
            valueFrom:
              secretKeyRef:
                name: db-secret
                key: password
          - name: DB_HOST
            valueFrom:
              secretKeyRef:
                name: db-secret
                key: host
          resources:
            requests:
              memory: "256Mi"
              cpu: "250m"
            limits:
              memory: "512Mi"
              cpu: "500m"
k8s/base/service.yaml: |
  apiVersion: v1
  kind: Service
  metadata:
    name: myapp
    namespace: production
  spec:
    selector:
      app: myapp
    ports:
    - port: 80
      targetPort: 8080
k8s/unrelated/vault/vault-agent.yaml: |
  # GARBAGE_K8S_406_VAULT_AGENT
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: GARBAGE_K8S_406_VAULT_INJECTOR
    namespace: vault
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: GARBAGE_K8S_406_VAULT_LABEL
    template:
      spec:
        containers:
        - name: vault-agent
          image: hashicorp/vault:GARBAGE_K8S_406_VAULT_VERSION
          env:
          - name: VAULT_ADDR
            value: GARBAGE_K8S_406_VAULT_ADDR
k8s/unrelated/external-secrets/controller.yaml: |
  # GARBAGE_K8S_406_ESO_CONTROLLER
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: GARBAGE_K8S_406_ESO_NAME
  spec:
    replicas: 1
    template:
      spec:
        containers:
        - name: controller
          image: ghcr.io/external-secrets/external-secrets:GARBAGE_K8S_406_ESO_TAG
