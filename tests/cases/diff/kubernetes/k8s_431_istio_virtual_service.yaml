name: k8s_431_istio_virtual_service
initial:
  destination-rule.yaml: |
    apiVersion: networking.istio.io/v1beta1
    kind: DestinationRule
    metadata:
      name: api
    spec:
      host: api
      subsets:
      - name: v1
        labels:
          version: v1
      - name: v2
        labels:
          version: v2
  virtual-service.yaml: |
    apiVersion: networking.istio.io/v1beta1
    kind: VirtualService
    metadata:
      name: api
    spec:
      hosts:
      - api
  unrelated.txt: |
    garbage_marker_k8s431 = True
    unused_marker_k8s431 = False
changed:
  virtual-service.yaml: |
    apiVersion: networking.istio.io/v1beta1
    kind: VirtualService
    metadata:
      name: api
    spec:
      hosts:
      - api
      http:
      - route:
        - destination:
            host: api
            subset: v1
          weight: 90
        - destination:
            host: api
            subset: v2
          weight: 10
assertions:
  must_include:
  - VirtualService
  must_not_include:
  - garbage_marker_k8s431
  - unused_marker_k8s431
options:
  commit_message: Add Istio virtual service
