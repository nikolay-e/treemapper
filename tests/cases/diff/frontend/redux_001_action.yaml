name: redux_001_action
initial:
  userSlice.ts: |
    import { createSlice, PayloadAction } from '@reduxjs/toolkit';

    export interface User {
        id: string;
        name: string;
        email: string;
    }

    export interface UserState {
        users: User[];
        currentUser: User | null;
        loading: boolean;
    }

    const initialState: UserState = {
        users: [],
        currentUser: null,
        loading: false,
    };

    export const userSlice = createSlice({
        name: 'user',
        initialState,
        reducers: {
            setUsers: (state, action: PayloadAction<User[]>) => {
                state.users = action.payload;
            },
            updateUser: (state, action: PayloadAction<User>) => {
                const index = state.users.findIndex(u => u.id === action.payload.id);
                if (index !== -1) {
                    state.users[index] = action.payload;
                }
                if (state.currentUser?.id === action.payload.id) {
                    state.currentUser = action.payload;
                }
            },
            setCurrentUser: (state, action: PayloadAction<User | null>) => {
                state.currentUser = action.payload;
            },
            setLoading: (state, action: PayloadAction<boolean>) => {
                state.loading = action.payload;
            },
        },
    });

    export const { setUsers, updateUser, setCurrentUser, setLoading } = userSlice.actions;
    export default userSlice.reducer;

    // redux_garbage_marker_001
    const GARBAGE_SLICE_CONFIG = { unused: true };
  UserEditor.tsx: |
    import React from 'react';

    export function UserEditor() {
        return <div>Initial</div>;
    }
changed:
  UserEditor.tsx: |
    import React, { useState } from 'react';
    import { useDispatch, useSelector } from 'react-redux';
    import { updateUser, User } from './userSlice';
    import type { RootState } from './store';

    export function UserEditor() {
        const dispatch = useDispatch();
        const currentUser = useSelector((state: RootState) => state.user.currentUser);
        const [name, setName] = useState(currentUser?.name || '');
        const [email, setEmail] = useState(currentUser?.email || '');

        const handleSave = () => {
            if (currentUser) {
                dispatch(updateUser({
                    ...currentUser,
                    name,
                    email,
                }));
            }
        };

        if (!currentUser) {
            return <p>No user selected</p>;
        }

        return (
            <div>
                <input value={name} onChange={e => setName(e.target.value)} />
                <input value={email} onChange={e => setEmail(e.target.value)} />
                <button onClick={handleSave}>Save</button>
            </div>
        );
    }
assertions:
  must_include:
  - UserEditor.tsx
  - dispatch
  - useSelector
  must_not_include:
  - redux_garbage_marker_001
options:
  commit_message: Add Redux dispatch with updateUser action
