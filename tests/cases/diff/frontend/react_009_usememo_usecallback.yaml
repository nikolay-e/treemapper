name: react_009_usememo_usecallback
initial:
  utils.ts: |
    export function expensiveCalculation(items: number[]): number {
        console.log('Running expensive calculation');
        return items.reduce((acc, item) => acc + item * item, 0);
    }

    export function formatNumber(num: number): string {
        return new Intl.NumberFormat('en-US').format(num);
    }

    // react_garbage_marker_009
    function garbageUtilFunction() { return 42; }
  DataDisplay.tsx: |
    import React from 'react';

    export function DataDisplay() {
        return <div>Initial</div>;
    }
changed:
  DataDisplay.tsx: |
    import React, { useMemo, useCallback, useState } from 'react';
    import { expensiveCalculation, formatNumber } from './utils';

    interface DataDisplayProps {
        items: number[];
    }

    export function DataDisplay({ items }: DataDisplayProps) {
        const [selectedIndex, setSelectedIndex] = useState<number | null>(null);

        const total = useMemo(() => {
            return expensiveCalculation(items);
        }, [items]);

        const formattedTotal = useMemo(() => {
            return formatNumber(total);
        }, [total]);

        const handleSelect = useCallback((index: number) => {
            setSelectedIndex(index);
        }, []);

        const handleReset = useCallback(() => {
            setSelectedIndex(null);
        }, []);

        return (
            <div>
                <p>Total: {formattedTotal}</p>
                <ul>
                    {items.map((item, index) => (
                        <li
                            key={index}
                            onClick={() => handleSelect(index)}
                            style={{ fontWeight: selectedIndex === index ? 'bold' : 'normal' }}
                        >
                            {item}
                        </li>
                    ))}
                </ul>
                <button onClick={handleReset}>Reset</button>
            </div>
        );
    }
assertions:
  must_include:
  - DataDisplay.tsx
  - useMemo
  - useCallback
  must_not_include:
  - react_garbage_marker_009
options:
  commit_message: Add useMemo and useCallback
