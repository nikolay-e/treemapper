name: react_006_custom_hook
initial:
  useApi.ts: |
    import { useState, useEffect } from 'react';

    export interface UseApiResult<T> {
        data: T | null;
        loading: boolean;
        error: Error | null;
        refetch: () => void;
    }

    export function useApi<T>(endpoint: string): UseApiResult<T> {
        const [data, setData] = useState<T | null>(null);
        const [loading, setLoading] = useState(true);
        const [error, setError] = useState<Error | null>(null);

        const fetchData = async () => {
            setLoading(true);
            try {
                const response = await fetch(endpoint);
                const result = await response.json();
                setData(result);
                setError(null);
            } catch (e) {
                setError(e as Error);
            } finally {
                setLoading(false);
            }
        };

        useEffect(() => {
            fetchData();
        }, [endpoint]);

        return { data, loading, error, refetch: fetchData };
    }

    // react_garbage_marker_006
    const GARBAGE_API_CONFIG = { timeout: 9999 };
  UserProfile.tsx: |
    import React from 'react';

    export function UserProfile() {
        return <div>Initial</div>;
    }
changed:
  UserProfile.tsx: |
    import React from 'react';
    import { useApi } from './useApi';

    interface User {
        id: string;
        name: string;
        email: string;
    }

    export function UserProfile({ userId }: { userId: string }) {
        const { data: user, loading, error, refetch } = useApi<User>(\`/users/\${userId}\`);

        if (loading) return <p>Loading...</p>;
        if (error) return <p>Error: {error.message}</p>;
        if (!user) return <p>User not found</p>;

        return (
            <div>
                <h1>{user.name}</h1>
                <p>{user.email}</p>
                <button onClick={refetch}>Refresh</button>
            </div>
        );
    }
assertions:
  must_include:
  - UserProfile.tsx
  - useApi
  must_not_include:
  - react_garbage_marker_006
options:
  commit_message: Add custom useApi hook usage
