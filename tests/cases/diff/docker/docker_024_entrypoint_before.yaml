src/main.py: |
  import sys
  import argparse
  import signal

  def signal_handler(signum, frame):
      print(f"Received signal {signum}, shutting down gracefully...")
      sys.exit(0)

  def main():
      parser = argparse.ArgumentParser()
      parser.add_argument('--config', default='/etc/app/config.yaml')
      parser.add_argument('--workers', type=int, default=4)
      parser.add_argument('command', choices=['serve', 'migrate', 'shell'])
      args = parser.parse_args()

      signal.signal(signal.SIGTERM, signal_handler)
      signal.signal(signal.SIGINT, signal_handler)

      print(f"Running {args.command} with config: {args.config}")

  if __name__ == '__main__':
      main()
requirements.txt: |
  pyyaml==6.0.1
  click==8.1.7
Dockerfile: |
  FROM python:3.11-slim
  WORKDIR /app
  COPY requirements.txt .
  RUN pip install -r requirements.txt
  COPY src/ ./src/
  CMD ["python", "src/main.py", "serve"]
scripts/docker_entrypoint.sh: |
  #!/bin/bash
  # GARBAGE_DOCKER_509_ENTRY_MARKER_001
  GARBAGE_DOCKER_509_ENTRY_VAR_002="entrypoint"
  exec python main.py "$@"
tests/test_cli.py: |
  # GARBAGE_DOCKER_509_TEST_MARKER_003
  GARBAGE_DOCKER_509_TEST_CLI_004 = {"args": ["serve"]}
  def test_cli():
      pass
docs/cli.md: |
  # CLI Usage
  GARBAGE_DOCKER_509_CLI_DOC_005
  GARBAGE_DOCKER_509_COMMANDS_006="serve,migrate,shell"
helm/values.yaml: |
  # GARBAGE_DOCKER_509_HELM_MARKER_007
  GARBAGE_DOCKER_509_HELM_VAR_008: default
  command: ["python"]
scripts/init.sh: |
  #!/bin/bash
  # GARBAGE_DOCKER_509_INIT_MARKER_009
  GARBAGE_DOCKER_509_INIT_VAR_010="init"
