app.py: "import os\nimport json\nfrom pathlib import Path\n\nDATA_DIR = Path(os.getenv(\"DATA_DIR\", \"/app/data\"))\nCONFIG_DIR = Path(os.getenv(\"CONFIG_DIR\", \"/app/config\"))\nLOGS_DIR = Path(os.getenv(\"\
  LOGS_DIR\", \"/app/logs\"))\n\ndef read_config(name: str) -> dict:\n    config_file = CONFIG_DIR / f\"{name}.json\"\n    if config_file.exists():\n        with open(config_file) as f:\n            return\
  \ json.load(f)\n    return {}\n\ndef write_data(filename: str, data: dict) -> None:\n    DATA_DIR.mkdir(parents=True, exist_ok=True)\n    with open(DATA_DIR / filename, 'w') as f:\n        json.dump(data,\
  \ f)\n\ndef append_log(message: str) -> None:\n    LOGS_DIR.mkdir(parents=True, exist_ok=True)\n    with open(LOGS_DIR / \"app.log\", 'a') as f:\n        f.write(f\"{message}\\n\")\n\nif __name__ == \"\
  __main__\":\n    config = read_config(\"app\")\n    write_data(\"output.json\", {\"status\": \"ok\"})\n    append_log(\"Application started\")\n"
requirements.txt: 'pyyaml==6.0.0

  '
Dockerfile: 'FROM python:3.12-slim

  WORKDIR /app

  COPY requirements.txt .

  RUN pip install -r requirements.txt

  COPY app.py .

  CMD ["python", "app.py"]

  '
docker-compose.yml: "version: '3.8'\n\nservices:\n  api:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    environment:\n      - DATA_DIR=/app/data\n      - CONFIG_DIR=/app/config\n     \
  \ - LOGS_DIR=/app/logs\n    volumes:\n      # Named volume for persistent data\n      - app_data:/app/data\n\n      # Bind mount for config (read-only)\n      - ./config:/app/config:ro\n\n      # Named\
  \ volume for logs\n      - app_logs:/app/logs\n\n      # Temporary filesystem for cache\n      - type: tmpfs\n        target: /app/cache\n        tmpfs:\n          size: 50M\n\n    restart: unless-stopped\n\
  \    healthcheck:\n      test: [\"CMD\", \"python\", \"-c\", \"import os; exit(0 if os.path.exists('/app/data') else 1)\"]\n      interval: 30s\n      timeout: 5s\n      retries: 3\n\n  backup:\n    image:\
  \ alpine:latest\n    volumes:\n      - app_data:/source:ro\n      - ./backups:/dest\n    command: sh -c \"tar -czf /dest/backup-$$(date +%Y%m%d-%H%M%S).tar.gz /source\"\n    profiles:\n      - maintenance\n\
  \nvolumes:\n  app_data:\n    driver: local\n    driver_opts:\n      type: none\n      o: bind\n      device: ${PWD}/persistent/data\n\n  app_logs:\n    driver: local\n    labels:\n      com.example.description:\
  \ \"Application logs\"\n      com.example.retention: \"30d\"\n"
scripts/volume_backup.sh: '#!/bin/bash

  tar -czf backup.tar.gz ./data

  '
tests/test_volumes.py: "def test_volume_mount():\n    pass\n"
docs/storage.md: '# Storage Configuration

  '
k8s/pvc.yaml: 'apiVersion: v1

  '
ansible/storage.yml: ''
