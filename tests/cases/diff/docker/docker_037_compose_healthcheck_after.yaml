api/src/app.py: "from flask import Flask, jsonify\nimport redis\nimport psycopg2\nimport os\n\napp = Flask(__name__)\n\ndef check_redis():\n    r = redis.from_url(os.environ.get('REDIS_URL', 'redis://redis:6379/0'))\n\
  \    return r.ping()\n\ndef check_database():\n    conn = psycopg2.connect(os.environ.get('DATABASE_URL'))\n    cur = conn.cursor()\n    cur.execute('SELECT 1')\n    return cur.fetchone()[0] == 1\n\n\
  @app.route('/health')\ndef health():\n    return jsonify(status='ok')\n\n@app.route('/ready')\ndef ready():\n    redis_ok = check_redis()\n    db_ok = check_database()\n    if redis_ok and db_ok:\n  \
  \      return jsonify(status='ready', redis=redis_ok, db=db_ok)\n    return jsonify(status='not_ready'), 503\n"
api/requirements.txt: 'flask==2.3.0

  redis==5.0.1

  psycopg2-binary==2.9.9

  '
api/Dockerfile: 'FROM python:3.12-slim

  WORKDIR /app

  COPY requirements.txt .

  RUN pip install -r requirements.txt

  COPY src/ ./src/

  CMD ["gunicorn", "-b", "0.0.0.0:8080", "src.app:app"]

  '
docker-compose.yml: "version: '3.8'\n\nservices:\n  api:\n    build: ./api\n    ports:\n      - \"8080:8080\"\n    environment:\n      - REDIS_URL=redis://redis:6379/0\n      - DATABASE_URL=postgresql://postgres:secret@db:5432/app\n\
  \    depends_on:\n      redis:\n        condition: service_healthy\n      db:\n        condition: service_healthy\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/ready\"\
  ]\n      interval: 30s\n      timeout: 10s\n      retries: 5\n      start_period: 60s\n\n  redis:\n    image: redis:7-alpine\n    command: redis-server --appendonly yes --maxmemory 256mb --maxmemory-policy\
  \ allkeys-lru\n    volumes:\n      - redis_data:/data\n    healthcheck:\n      test: [\"CMD\", \"redis-cli\", \"ping\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n      start_period: 10s\n\
  \n  db:\n    image: postgres:16-alpine\n    environment:\n      - POSTGRES_USER=postgres\n      - POSTGRES_PASSWORD=secret\n      - POSTGRES_DB=app\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\
  \    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U postgres -d app\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n      start_period: 30s\n\nvolumes:\n  redis_data:\n  postgres_data:\n"
scripts/health_monitor.sh: '#!/bin/bash

  while true; do curl localhost/health; sleep 30; done

  '
tests/test_health.py: "def test_health():\n    pass\n"
docs/healthcheck.md: '# Health Checks

  '
monitoring/probes.yaml: ''
alerting/rules.yaml: ''
