api/src/app.py: |
  from flask import Flask, jsonify
  import os

  app = Flask(__name__)
  DEBUG = os.environ.get('DEBUG', 'false').lower() == 'true'

  @app.route('/health')
  def health():
      return jsonify(status='ok', debug=DEBUG)

  @app.route('/debug/config')
  def debug_config():
      if not DEBUG:
          return jsonify(error='Debug mode disabled'), 403
      return jsonify(config=dict(os.environ))
api/Dockerfile: |
  FROM python:3.12-slim
  WORKDIR /app
  COPY requirements.txt .
  RUN pip install -r requirements.txt
  COPY src/ ./src/
  CMD ["gunicorn", "-b", "0.0.0.0:8080", "src.app:app"]
api/requirements.txt: |
  flask==2.3.0
  gunicorn==21.2.0
docker-compose.yml: |
  version: '3.8'
  services:
    api:
      build: ./api
    db:
      image: postgres:16-alpine
scripts/run_debug.sh: |
  #!/bin/bash
  # GARBAGE_DOCKER_523_DEBUG_MARKER_001
  GARBAGE_DOCKER_523_DEBUG_VAR_002="enabled"
  docker-compose --profile debug up
tests/test_profiles.py: |
  # GARBAGE_DOCKER_523_TEST_MARKER_003
  GARBAGE_DOCKER_523_TEST_PROFILE_004 = {"name": "debug"}
  def test_profiles():
      pass
docs/profiles.md: |
  # Compose Profiles
  GARBAGE_DOCKER_523_PROF_DOC_005
  GARBAGE_DOCKER_523_PROFILES_006="debug,monitoring,testing"
k8s/overlays/dev.yaml: |
  # GARBAGE_DOCKER_523_K8S_MARKER_007
  GARBAGE_DOCKER_523_OVERLAY_008: development
.env.local: |
  # GARBAGE_DOCKER_523_ENV_MARKER_009
  GARBAGE_DOCKER_523_LOCAL_010=true
