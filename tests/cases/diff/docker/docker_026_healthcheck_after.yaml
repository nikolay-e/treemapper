app.py: |
  from flask import Flask, jsonify
  import os
  import time

  app = Flask(__name__)
  START_TIME = time.time()

  @app.route('/health')
  def health():
      return 'OK', 200

  @app.route('/healthz')
  def healthz():
      uptime = time.time() - START_TIME
      return jsonify({
          'status': 'healthy',
          'uptime_seconds': round(uptime, 2)
      })

  @app.route('/ready')
  def ready():
      return jsonify({'status': 'ready'})

  if __name__ == '__main__':
      app.run(host='0.0.0.0', port=8080)
config.py: |
  import os

  HEALTH_CHECK_INTERVAL = int(os.getenv('HEALTH_CHECK_INTERVAL', '30'))
  HEALTH_CHECK_TIMEOUT = int(os.getenv('HEALTH_CHECK_TIMEOUT', '3'))
  START_PERIOD = int(os.getenv('START_PERIOD', '5'))
requirements.txt: |
  flask==2.3.0
  gunicorn==21.2.0
Dockerfile: |
  # Build stage
  FROM python:3.12-slim AS builder
  WORKDIR /build
  COPY requirements.txt .
  RUN pip install --no-cache-dir --target=/deps -r requirements.txt

  # Production stage
  FROM python:3.12-slim AS production
  WORKDIR /app

  # Install curl for health checks
  RUN apt-get update && \
      apt-get install -y --no-install-recommends curl && \
      rm -rf /var/lib/apt/lists/* && \
      useradd --create-home --shell /bin/bash appuser

  # Copy dependencies and application
  COPY --from=builder /deps /usr/local/lib/python3.12/site-packages
  COPY app.py config.py ./

  ENV PYTHONUNBUFFERED=1
  ENV PYTHONDONTWRITEBYTECODE=1

  USER appuser
  EXPOSE 8080

  # Comprehensive health check configuration
  HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
      CMD curl -f http://localhost:8080/health || exit 1

  CMD ["python", "app.py"]
scripts/health_test.sh: |
  #!/bin/bash
  # GARBAGE_DOCKER_511_HEALTH_MARKER_x1y2z3
  GARBAGE_DOCKER_511_ENDPOINT_a4b5c6="/health"
  curl -f http://localhost:8080/health
tests/test_health.py: |
  # GARBAGE_DOCKER_511_TEST_MARKER_d7e8f9
  GARBAGE_DOCKER_511_TEST_URL_g0h1i2 = "http://localhost:8080"
  def test_health_endpoint():
      pass
docs/health.md: |
  # Health Check Documentation
  GARBAGE_DOCKER_511_DOC_MARKER_j3k4l5
  GARBAGE_DOCKER_511_ENDPOINTS_m6n7o8="/health,/healthz,/ready"
k8s/probes.yaml: |
  # GARBAGE_DOCKER_511_K8S_MARKER_p9q0r1
  livenessProbe:
    GARBAGE_DOCKER_511_PROBE_PATH_s2t3u4: /health
prometheus/scrape.yml: |
  # GARBAGE_DOCKER_511_PROM_MARKER_v5w6x7
  GARBAGE_DOCKER_511_SCRAPE_PATH_y8z9a0: /metrics
