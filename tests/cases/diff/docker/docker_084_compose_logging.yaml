name: docker_084_compose_logging
initial:
  docker-compose.yml: |
    version: '3.8'
    services:
      app:
        build: .
        logging:
          driver: json-file
  src/logger.py: |
    import logging

    logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(message)s')
    logger = logging.getLogger(__name__)

    def log_event(message: str):
        logger.info(message)
changed:
  docker-compose.yml: |
    version: '3.8'
    services:
      app:
        build: .
        logging:
          driver: json-file
          options:
            max-size: "10m"
            max-file: "3"
            labels: "app,env"
assertions:
  must_include:
    - log_event
options:
  commit_message: configure logging
