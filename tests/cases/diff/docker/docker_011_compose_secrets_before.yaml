src/app.py: "from flask import Flask, jsonify\nimport os\n\napp = Flask(__name__)\n\ndef get_db_password():\n    with open(\"/run/secrets/db_password\") as f:\n        return f.read().strip()\n\ndef create_db_url():\n\
  \    password = get_db_password()\n    host = os.getenv(\"DB_HOST\", \"db\")\n    return f\"postgresql://app:{password}@{host}:5432/appdb\"\n\n@app.route('/health')\ndef health():\n    return jsonify(status='ok')\n\
  \n@app.route('/api/data')\ndef get_data():\n    db_url = create_db_url()\n    return jsonify(db_url_configured=bool(db_url))\n\nif __name__ == \"__main__\":\n    app.run(host=\"0.0.0.0\", port=8080)\n"
src/config.py: "import os\n\ndef get_db_password():\n    with open(\"/run/secrets/db_password\") as f:\n        return f.read().strip()\n\nDB_HOST = os.getenv(\"DB_HOST\", \"db\")\nDB_PORT = int(os.getenv(\"\
  DB_PORT\", \"5432\"))\nDB_NAME = os.getenv(\"DB_NAME\", \"appdb\")\n"
requirements.txt: 'flask==2.3.0

  gunicorn==21.2.0

  psycopg2-binary==2.9.9

  '
Dockerfile: 'FROM python:3.12-slim

  WORKDIR /app

  COPY requirements.txt .

  RUN pip install --no-cache-dir -r requirements.txt

  COPY src/ ./src/

  USER nobody

  EXPOSE 8080

  CMD ["gunicorn", "-b", "0.0.0.0:8080", "src.app:app"]

  '
docker-compose.yml: "version: '3.8'\nservices:\n  app:\n    build: .\n    ports:\n      - \"8080:8080\"\n    environment:\n      - DB_HOST=db\n    secrets:\n      - db_password\n    depends_on:\n      -\
  \ db\n  db:\n    image: postgres:16-alpine\n    environment:\n      POSTGRES_PASSWORD_FILE: /run/secrets/db_password\n      POSTGRES_DB: appdb\n    secrets:\n      - db_password\n    volumes:\n      -\
  \ pgdata:/var/lib/postgresql/data\nsecrets:\n  db_password:\n    file: ./secrets/db_password.txt\nvolumes:\n  pgdata:\n"
scripts/rotate_secrets.sh: '#!/bin/bash

  echo "Rotating secrets..."

  '
tests/test_secrets.py: "def test_secret_loading():\n    pass\n"
docs/security.md: '# Security Guide

  '
k8s/sealed-secret.yaml: 'apiVersion: bitnami.com/v1alpha1

  '
monitoring/alerts.yml: ''
