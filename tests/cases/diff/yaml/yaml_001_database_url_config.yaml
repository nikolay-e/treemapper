name: yaml_001_database_url_config
initial:
  config.yaml: |
    database:
      host: localhost
      port: 5432
      name: myapp
  src/db.py: |
    import os

    def get_database_url():
        host = os.getenv("DB_HOST", "localhost")
        port = os.getenv("DB_PORT", "5432")
        name = os.getenv("DB_NAME", "myapp")
        return f"postgresql://{host}:{port}/{name}"
changed:
  config.yaml: |
    database:
      host: production-db.example.com
      port: 5432
      name: myapp_prod
assertions:
  must_include:
    - get_database_url
options:
  commit_message: update db config
