name: yaml_012_queue_config
initial:
  config/queue.yaml: |
    queue:
      broker: redis://localhost:6379
      backend: redis://localhost:6379
  src/tasks.py: |
    from celery import Celery

    def create_celery_app(broker: str, backend: str):
        return Celery(__name__, broker=broker, backend=backend)
changed:
  config/queue.yaml: |
    queue:
      broker: amqp://rabbitmq:5672
      backend: redis://redis:6379
      prefetch_count: 4
assertions:
  must_include:
    - create_celery_app
options:
  commit_message: switch to rabbitmq
