swagger.yaml: |
  swagger: "2.0"
  info:
    title: User API
    version: 1.0.0
  basePath: /api/v1
  securityDefinitions:
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
    oauth2:
      type: oauth2
      flow: accessCode
      authorizationUrl: https://auth.example.com/authorize
      tokenUrl: https://auth.example.com/token
      scopes:
        read:users: Read user data
        write:users: Modify user data
        admin:users: Full administrative access
    bearerAuth:
      type: apiKey
      in: header
      name: Authorization
      description: JWT Bearer token
  security:
    - apiKey: []
  paths:
    /users:
      get:
        summary: List users
        security:
          - apiKey: []
          - oauth2: [read:users]
          - bearerAuth: []
        responses:
          200:
            description: Success
          401:
            description: Unauthorized
          403:
            description: Forbidden
    /users/{id}:
      put:
        summary: Update user
        security:
          - oauth2: [write:users]
        responses:
          200:
            description: Updated
          401:
            description: Unauthorized

src/middleware/auth.py: |
  from functools import wraps
  from flask import request, jsonify

  def require_api_key(func):
      @wraps(func)
      def wrapper(*args, **kwargs):
          api_key = request.headers.get('X-API-Key')
          if not api_key:
              return jsonify({'error': 'API key required'}), 401
          if not validate_api_key(api_key):
              return jsonify({'error': 'Invalid API key'}), 403
          return func(*args, **kwargs)
      return wrapper

  def validate_api_key(api_key: str) -> bool:
      return api_key in get_valid_api_keys()

garbage_auth_handler.ts: |
  const GARBAGE_CICD_DOCS_062_AUTH_MARKER_A = "jwt";
  const GARBAGE_CICD_DOCS_062_EXPIRE_MARKER_B = 3600;

  class GarbageAuthHandler {
    static GARBAGE_CICD_DOCS_062_REFRESH_MARKER_C = true;
    authenticate(): void {}
  }

garbage_security_validator.ts: |
  const GARBAGE_CICD_DOCS_062_VALIDATE_MARKER_D = "strict";
  const GARBAGE_CICD_DOCS_062_SCOPE_MARKER_E = "read";

  class GarbageSecurityValidator {
    static GARBAGE_CICD_DOCS_062_AUDIT_MARKER_F = false;
    validate(): boolean { return true; }
  }
