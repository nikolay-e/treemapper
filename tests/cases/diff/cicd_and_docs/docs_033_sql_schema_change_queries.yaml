name: docs_033_sql_schema_change_queries
initial:
  sql/queries/get_user_orders.sql: |
    SELECT
        o.id,
        o.total,
        o.created_at
    FROM orders o
    WHERE o.user_id = :user_id
    ORDER BY o.created_at DESC;
changed:
  sql/queries/get_user_orders.sql: |
    SELECT
        o.id,
        o.total,
        o.status,
        o.created_at,
        o.updated_at
    FROM orders o
    WHERE o.user_id = :user_id
      AND o.status != 'cancelled'
    ORDER BY o.created_at DESC
    LIMIT :limit OFFSET :offset;
assertions:
  must_include:
  - get_user_orders.sql
  must_not_include:
  - garbage_marker_12345
  - unused_marker_67890
