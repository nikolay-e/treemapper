name: ruby_289_method_missing
initial:
  dynamic_struct.rb: |
    class DynamicStruct
      def initialize(hash = {})
        @data = hash
      end

      def method_missing(name, *args)
        if name.to_s.end_with?('=')
          @data[name.to_s.chop.to_sym] = args.first
        else
          @data[name]
        end
      end

      def respond_to_missing?(name, include_private = false)
        true
      end
    end
  app.rb: |
    # Initial
    puts 'Hello'
changed:
  app.rb: |
    require_relative 'dynamic_struct'

    obj = DynamicStruct.new(name: 'John')
    puts obj.name
    obj.email = 'john@example.com'
    puts obj.email
assertions:
  must_include:
  - DynamicStruct.new
  must_not_include:
  - garbage_marker_12345
  - unused_marker_67890
options:
  commit_message: Add method_missing usage
