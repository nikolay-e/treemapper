name: tf_036_lambda_handler
initial:
  main.tf: |
    resource "aws_lambda_function" "api" {
      filename      = "lambda.zip"
      function_name = "api-handler"
      handler       = "src/api.handler"
      runtime       = "nodejs18.x"
    }
  src/api.ts: |
    export const handler = async (event: any) => {
      return { statusCode: 200, body: JSON.stringify({ ok: true }) };
    };
changed:
  main.tf: |
    resource "aws_lambda_function" "api" {
      filename      = "lambda.zip"
      function_name = "api-handler-v2"
      handler       = "src/api.handler"
      runtime       = "nodejs20.x"
      memory_size   = 512
    }
assertions:
  must_include:
    - export const handler
options:
  commit_message: update lambda
