name: terraform_455_cloudwatch_alarm
initial:
  monitoring.tf: |
    # Monitoring resources
changed:
  monitoring.tf: |
    resource "aws_cloudwatch_metric_alarm" "cpu_high" {
      alarm_name          = "cpu-high"
      comparison_operator = "GreaterThanThreshold"
      evaluation_periods  = 2
      metric_name         = "CPUUtilization"
      namespace           = "AWS/EC2"
      period              = 300
      statistic           = "Average"
      threshold           = 80

      dimensions = {
        AutoScalingGroupName = aws_autoscaling_group.web.name
      }

      alarm_actions = [aws_sns_topic.alerts.arn]
    }
assertions:
  must_include:
  - monitoring.tf
options:
  commit_message: Add CloudWatch alarm
