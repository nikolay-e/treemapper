name: terraform_492_provisioner_local_exec
initial:
  main.tf: |
    resource "aws_instance" "web" {
      ami           = var.ami_id
      instance_type = "t3.micro"
    }
changed:
  main.tf: |
    resource "aws_instance" "web" {
      ami           = var.ami_id
      instance_type = "t3.micro"

      provisioner "local-exec" {
        command = "echo ${self.private_ip} >> private_ips.txt"
      }

      provisioner "local-exec" {
        when    = destroy
        command = "sed -i '/${self.private_ip}/d' private_ips.txt"
      }
    }
assertions:
  must_include:
  - main.tf
options:
  commit_message: Add local-exec provisioner
