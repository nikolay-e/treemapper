name: terraform_475_count
initial:
  main.tf: |
    resource "aws_instance" "web" {
      ami           = var.ami_id
      instance_type = "t3.micro"
    }
changed:
  main.tf: |
    variable "instance_count" {
      default = 3
    }

    resource "aws_instance" "web" {
      count         = var.instance_count
      ami           = var.ami_id
      instance_type = "t3.micro"

      tags = {
        Name = "web-${count.index}"
      }
    }
assertions:
  must_include:
  - main.tf
options:
  commit_message: Add count
