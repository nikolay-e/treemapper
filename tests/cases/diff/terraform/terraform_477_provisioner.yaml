name: terraform_477_provisioner
initial:
  main.tf: |
    resource "aws_instance" "web" {
      ami           = var.ami_id
      instance_type = "t3.micro"
    }
changed:
  main.tf: |
    resource "aws_instance" "web" {
      ami           = var.ami_id
      instance_type = "t3.micro"

      provisioner "remote-exec" {
        inline = [
          "sudo yum update -y",
          "sudo yum install -y docker",
          "sudo systemctl start docker"
        ]

        connection {
          type        = "ssh"
          user        = "ec2-user"
          private_key = file(var.private_key_path)
          host        = self.public_ip
        }
      }
    }
assertions:
  must_include:
  - main.tf
options:
  commit_message: Add provisioner
