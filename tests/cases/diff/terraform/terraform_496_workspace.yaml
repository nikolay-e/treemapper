name: terraform_496_workspace
initial:
  main.tf: |
    resource "aws_instance" "web" {
      ami           = var.ami_id
      instance_type = "t3.micro"
    }
changed:
  main.tf: |
    locals {
      environment = terraform.workspace
      is_prod     = terraform.workspace == "production"
    }

    resource "aws_instance" "web" {
      ami           = var.ami_id
      instance_type = local.is_prod ? "t3.large" : "t3.micro"

      tags = {
        Environment = local.environment
      }
    }
assertions:
  must_include:
  - main.tf
options:
  commit_message: Add workspace-based configuration
