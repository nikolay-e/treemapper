name: swift_codable
initial:
  User.swift: |
    struct User: Codable {
        let id: String
        let name: String
        let email: String
    }
  APIResponse.swift: |
    struct APIResponse<T: Codable>: Decodable {
        let data: T
        let status: String
        let timestamp: Date
    }
  APIClient.swift: |
    // Initial
    class APIClient {}
changed:
  APIClient.swift: |
    import Foundation

    class APIClient {
        func fetchUsers(completion: @escaping (Result<APIResponse<[User]>, Error>) -> Void) {
            let url = URL(string: "https://api.example.com/users")!
            URLSession.shared.dataTask(with: url) { data, _, error in
                if let error = error {
                    completion(.failure(error))
                    return
                }
                guard let data = data else { return }
                do {
                    let decoder = JSONDecoder()
                    decoder.dateDecodingStrategy = .iso8601
                    let response = try decoder.decode(APIResponse<[User]>.self, from: data)
                    completion(.success(response))
                } catch {
                    completion(.failure(error))
                }
            }.resume()
        }
    }
assertions:
  must_include:
  - APIClient.swift
  - JSONDecoder
  - APIResponse<[User]>
options:
  commit_message: Add Codable decoding
