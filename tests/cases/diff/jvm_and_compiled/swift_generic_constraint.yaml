name: swift_generic_constraint
initial:
  Repository.swift: |
    protocol Repository {
        associatedtype Entity
        func save(_ entity: Entity)
        func find(id: String) -> Entity?
        func delete(id: String)
    }
  CacheService.swift: |
    // Initial
    class CacheService {}
changed:
  CacheService.swift: |
    class CacheService<T: Comparable & Hashable> {
        private var cache: [String: T] = [:]

        func store(_ value: T, forKey key: String) {
            cache[key] = value
        }

        func retrieve(forKey key: String) -> T? {
            return cache[key]
        }

        func process<U: Numeric>(_ items: [U]) -> U {
            return items.reduce(0, +)
        }

        func filter<C: Collection>(items: C, predicate: (C.Element) -> Bool)
            -> [C.Element] where C.Element: Comparable {
            return items.filter(predicate).sorted()
        }
    }
assertions:
  must_include:
  - CacheService.swift
  - 'T: Comparable & Hashable'
  - 'where C.Element: Comparable'
options:
  commit_message: Add generic constraints
