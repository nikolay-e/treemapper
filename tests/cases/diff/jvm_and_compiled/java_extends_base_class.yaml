name: java_extends_base_class
initial:
  src/main/java/com/example/BaseEntity.java: |
    package com.example;

    import javax.persistence.*;
    import java.time.LocalDateTime;

    @MappedSuperclass
    public abstract class BaseEntity {
        @Id
        @GeneratedValue(strategy = GenerationType.IDENTITY)
        private Long id;

        @Column(name = "created_at")
        private LocalDateTime createdAt;

        public Long getId() { return id; }
        public LocalDateTime getCreatedAt() { return createdAt; }
    }
  src/main/java/com/example/Product.java: |
    package com.example;

    import javax.persistence.*;

    @Entity
    public class Product extends BaseEntity {
        private String name;
        private Double price;
    }
changed:
  src/main/java/com/example/BaseEntity.java: |
    package com.example;

    import javax.persistence.*;
    import java.time.LocalDateTime;

    @MappedSuperclass
    public abstract class BaseEntity {
        @Id
        @GeneratedValue(strategy = GenerationType.IDENTITY)
        private Long id;

        @Column(name = "created_at")
        private LocalDateTime createdAt;

        @Column(name = "updated_at")
        private LocalDateTime updatedAt;

        @PreUpdate
        protected void onUpdate() {
            updatedAt = LocalDateTime.now();
        }

        public Long getId() { return id; }
        public LocalDateTime getCreatedAt() { return createdAt; }
        public LocalDateTime getUpdatedAt() { return updatedAt; }
    }
assertions:
  must_include:
  - BaseEntity.java
  - updatedAt
  - onUpdate
options:
  commit_message: Add updatedAt field with PreUpdate
