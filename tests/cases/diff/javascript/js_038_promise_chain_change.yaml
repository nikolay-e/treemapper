name: js_038_promise_chain_change
initial:
  api.ts: |
    export function fetchData(): Promise<{ data: string }> {
        return fetch('/api/data').then(res => res.json());
    }
  consumer.ts: |
    import { fetchData } from './api';

    fetchData().then(result => {
        console.log(result.data);
    });
changed:
  api.ts: |
    export function fetchData(): Promise<{ data: string; metadata: { timestamp: number } }> {
        return fetch('/api/data')
            .then(res => res.json())
            .then(data => ({
                ...data,
                metadata: { timestamp: Date.now() },
            }));
    }
assertions:
  must_include:
  - fetchData
  - api.ts
  must_not_include:
  - js_garbage_marker_001
options:
  commit_message: Add metadata to fetchData
