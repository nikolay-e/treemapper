name: helm_065_values_env_vars
initial:
  chart/values.yaml: |
    env:
      - name: APP_ENV
        value: development
  chart/templates/deployment.yaml: |
    apiVersion: apps/v1
    kind: Deployment
    spec:
      template:
        spec:
          containers:
            - name: app
              env:
                {{- toYaml .Values.env | nindent 12 }}
changed:
  chart/values.yaml: |
    env:
      - name: APP_ENV
        value: production
      - name: LOG_LEVEL
        value: warn
      - name: DB_HOST
        valueFrom:
          secretKeyRef:
            name: db-secret
            key: host
assertions:
  must_include:
    - Deployment
options:
  commit_message: add production env
