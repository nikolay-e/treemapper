name: helm_559_capabilities
initial:
  templates/ingress.yaml: |
    apiVersion: networking.k8s.io/v1
    kind: Ingress
  unrelated.txt: |
    garbage_marker_12345
    unused_marker_67890
changed:
  templates/ingress.yaml: |
    {{- if .Capabilities.APIVersions.Has "networking.k8s.io/v1" }}
    apiVersion: networking.k8s.io/v1
    {{- else }}
    apiVersion: extensions/v1beta1
    {{- end }}
    kind: Ingress
assertions:
  must_include:
  - Capabilities.APIVersions
  must_not_include:
  - garbage_marker_12345
  - unused_marker_67890
options:
  commit_message: Add capabilities check
