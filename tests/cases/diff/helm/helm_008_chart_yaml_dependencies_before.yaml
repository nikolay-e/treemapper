chart/Chart.yaml: |
  apiVersion: v2
  name: myapp
  description: Full-stack web application
  type: application
  version: 1.0.0
  appVersion: "1.0.0"
  dependencies:
    - name: postgresql
      version: "12.1.0"
      repository: https://charts.bitnami.com/bitnami
chart/values.yaml: |
  replicaCount: 2
  image:
    repository: myapp
    tag: "1.0.0"
  postgresql:
    enabled: true
    auth:
      database: myapp
chart/templates/deployment.yaml: |
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: {{ .Release.Name }}-myapp
  spec:
    replicas: {{ .Values.replicaCount }}
    template:
      spec:
        containers:
          - name: myapp
            image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"
            env:
              - name: DATABASE_HOST
                value: {{ .Release.Name }}-postgresql
src/db.py: |
  import psycopg2

  def get_connection():
      return psycopg2.connect(host="postgresql", database="myapp")

  def execute_query(query, params=None):
      conn = get_connection()
      cursor = conn.cursor()
      cursor.execute(query, params)
      return cursor.fetchall()
chart/templates/migration-job.yaml: |
  apiVersion: batch/v1
  kind: Job
  metadata:
    name: GARBAGE_HELM_008_MIGRATION_JOB_A
  spec:
    template:
      spec:
        containers:
          - name: GARBAGE_HELM_008_MIGRATION_CONTAINER_B
            command: ["GARBAGE_HELM_008_MIGRATION_CMD_C"]
        restartPolicy: Never
chart/docs/database-guide.md: |
  # Database Guide
  GARBAGE_HELM_008_DB_GUIDE_D
  ## Schema Migrations
  GARBAGE_HELM_008_SCHEMA_SECTION_E
