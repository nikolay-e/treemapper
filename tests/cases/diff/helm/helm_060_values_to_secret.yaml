name: helm_060_values_to_secret
initial:
  chart/values.yaml: |
    secrets:
      dbPassword: changeme
  chart/templates/secret.yaml: |
    apiVersion: v1
    kind: Secret
    metadata:
      name: {{ .Release.Name }}-secrets
    type: Opaque
    data:
      DB_PASSWORD: {{ .Values.secrets.dbPassword | b64enc }}
changed:
  chart/values.yaml: |
    secrets:
      dbPassword: prod-secret
      apiKey: my-api-key
assertions:
  must_include:
    - Secret
options:
  commit_message: add api key
